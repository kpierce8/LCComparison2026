# LCComparison2026 Main Configuration
# Compare foundation models against LCAnalysis2026 models

project:
  name: "LCComparison2026"
  description: "Land Cover Model Comparison Framework"
  region: "Washington State"
  version: "0.1.0"

# ---- Existing Model Integration ----
existing_models:
  base_path: "/media/ken/data/LCAnalysis2026"
  experiments_dir: "experiments"
  config_filename: "config.yaml"
  metrics_filename: "final_metrics.yaml"
  metadata_filename: "experiment_metadata.yaml"
  checkpoint_dir: "checkpoints"
  # Auto-discovered config output
  discovery_output: "config/existing_model_config.yaml"

# ---- 7-Class Schema ----
class_schema:
  num_classes: 7
  classes:
    water: 0
    trees: 1
    shrub: 2
    grass: 3
    crops: 4
    built: 5
    bare: 6
  colors:
    water: "#0077BE"
    trees: "#228B22"
    shrub: "#90EE90"
    grass: "#ADFF2F"
    crops: "#FFD700"
    built: "#DC143C"
    bare: "#D2B48C"
  # Mapping from LCAnalysis2026 8-class indices to 7-class indices
  lcanalysis_mapping:
    0: 6   # background -> bare
    1: 1   # trees -> trees
    2: 2   # shrubs -> shrub
    3: 3   # herbaceous -> grass
    4: 6   # ground -> bare
    5: 0   # water -> water
    6: 6   # gravel -> bare
    7: 5   # built -> built

# ---- Study Area ----
study_area:
  name: "Washington State"
  bbox:
    west: -124.85
    south: 45.54
    east: -116.92
    north: 49.00
  crs: "EPSG:4326"
  target_crs: "EPSG:32610"  # UTM Zone 10N

# ---- Tile Configuration ----
tiles:
  size: 256
  resolution: 10.0  # meters
  overlap: 0
  source: "sentinel2"

# ---- GEE Export ----
gee_export:
  strategy: "drive"
  drive_folder: "LCComparison2026_exports"
  cloud_bucket: null
  collections:
    sentinel2:
      collection_id: "COPERNICUS/S2_SR_HARMONIZED"
      bands: ["B2", "B3", "B4", "B8", "B11", "B12"]
      cloud_filter: 20
      date_range:
        start: "2024-06-01"
        end: "2024-09-30"
    naip:
      collection_id: "USDA/NAIP/DOQQ"
      bands: ["R", "G", "B", "N"]
      year: 2023
  scale: 10
  max_pixels: 1e9

# ---- Processing ----
processing:
  device: "cuda"
  batch_size: 32
  num_workers: 4
  pin_memory: true
  prefetch_factor: 2

# ---- Foundation Models ----
foundation_models:
  prithvi:
    enabled: true
    model_id: "ibm-nasa-geospatial/Prithvi-100M"
    source: "huggingface"
    weights_dir: "models/prithvi"
    input_bands: ["B2", "B3", "B4", "B8", "B11", "B12"]
    input_size: 224
    embedding_dim: 768
  satlas:
    enabled: true
    model_id: "allenai/satlas-pretrain"
    source: "huggingface"
    weights_dir: "models/satlas"
    input_bands: ["B2", "B3", "B4"]
    input_size: 256
    embedding_dim: 1024
  ssl4eo:
    enabled: true
    model_id: "ssl4eo-s12"
    source: "manual"
    weights_dir: "models/ssl4eo"
    input_bands: ["B2", "B3", "B4", "B8", "B11", "B12"]
    input_size: 224
    embedding_dim: 768

# ---- Embedding Extraction ----
embeddings:
  output_dir: "data/embeddings"
  batch_size: 64
  save_format: "npz"
  normalize: true

# ---- Classification Head ----
classification:
  method: "xgboost"  # xgboost, mlp, linear
  xgboost:
    n_estimators: 500
    max_depth: 8
    learning_rate: 0.1
    subsample: 0.8
    colsample_bytree: 0.8
    early_stopping_rounds: 50
  mlp:
    hidden_dims: [512, 256]
    dropout: 0.3
    learning_rate: 0.001
    epochs: 100
  linear:
    regularization: "l2"
    C: 1.0

# ---- Validation ----
validation:
  metrics: ["accuracy", "f1", "iou", "kappa"]
  per_class: true
  confusion_matrix: true
  spatial_metrics: true
  cross_validation:
    enabled: true
    n_folds: 5
    stratified: true

# ---- Outputs ----
outputs:
  predictions_dir: "data/predictions"
  reports_dir: "data/outputs"
  figures_dir: "data/outputs/figures"
  format: "geotiff"
  comparison_report: true

# ---- Logging ----
logging:
  level: "INFO"
  file: "logs/lccomparison.log"
  console: true
  rich_formatting: true

# ---- Paths ----
paths:
  data_dir: "data"
  models_dir: "models"
  config_dir: "config"
  logs_dir: "logs"
